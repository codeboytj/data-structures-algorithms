package cumt.tj.learn.offer;

/**
 * Created by sky on 17-7-6.
 * 题目：把一个数组最开始的若干个元素搬到数组的末尾，我们称之为数组的旋转。 输入一个非递减排序的数组的一个旋转，
 * 输出旋转数组的最小元素。 例如数组{3,4,5,1,2}为{1,2,3,4,5}的一个旋转，该数组的最小值为1。
 * NOTE：给出的所有元素都大于0，若数组大小为0，请返回0。
 * 思路：
 *      对于旋转后的数组B，以最小元素为分割点，左右2个数组C、D刚好都是递增数组，而且C的元素都大于D中的元素。
 *      B=[C,最小元素,D]，可以利用这样的特点，采用二分查找的思路进行查找：
 *      1. 持有2个指针指向首尾，如果中间元素大于首元素，那么中间元素仍然位于C中，这样就可以缩小范围为[中间元素，最小元素，D]
 *      2. 如果中间元素小于首元素，那么缩小范围为[C,最小元素,中间元素]
 *      3. ……
 *      4. 直到2个指针直到同一个元素，就是最小元
 *      而对于数组中有想等元素的时候，就比较麻烦了
 *      在中间元与起始元想等时：
 *      1. 如果中点比末尾点大，那么最小点在中点与末尾之间
 *      2. 如果中点与末尾想等，什么都排除不了，这能逐个移动起始元指针
 */
public class MinInRotateArray {

    public int minNumberInRotateArray(int [] array) {

        return minNumberInRotateArray(array,0,array.length);

    }

    public int minNumberInRotateArray(int [] array,int lower,int upper) {

        int center;
        while (true) {

            if(array[lower]<array[upper-1]){
                //特殊情况，旋转0个元素
                return array[lower];
            }

            if(lower==upper-2)
                //只剩2个元素了，返回最小的
                return Math.min(array[lower],array[upper-1]);

            //中点
            center = (lower + upper-1) / 2;
            if (array[center] > array[lower]) {
                lower=center;
            } else if (array[center] < array[lower]) {
                //并不能排除center点，因为最小点也小于起点
                upper=center+1;
            } else {
                //想等的情况
                if (array[center] > array[upper - 1]){
                    //如果中点比末尾点大，那么最小点在中点与末尾之间
                    lower = center;
                }else {
                    //如果中点与末尾想等，什么都排除不了，这能逐个移动指针
                    lower++;
                }
            }
        }

    }

    public static void main(String[] args) {
        MinInRotateArray minInRotateArray=new MinInRotateArray();
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{9995,9997,9999,10000,10000,10000,10000,10000,10000,1,1,1,2,2,3,3,3,6,11}));
        System.out.println(minInRotateArray.minNumberInRotateArray(new int[]{0,1,2,3}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,2,3,0}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,2,3,4,0}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,0,1,1,1}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,1,1,0,1}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,1,1,0}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{1,1,1,1,0}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{7877,7878,7879,7880,7881,7882,7884,7884,7884,7885,7887,7888,7889,7891,7892,7893,7894,7895,7895,7896,7897,7897,7904,7904,7904,7905,7906,7907,7909,7910,7911,7912,7913,7916,7917,7918,7918,7918,7919,7919,7922,7924,7926,7926,7926,7930,7931,7935,7936,7937,7939,7939,7942,7943,7944,7946,7947,7949,7951,7960,7965,7965,7971,7973,7974,7976,7976,7977,7978,7978,7980,7981,7982,7983,7984,7986,7986,7994,7995,7996,7997,7998,7998,8000,8001,8008,8008,8009,8009,8010,8011,8011,8013,8013,8014,8016,8019,8020,8020,8022,8023,8026,8029,8033,8035,8036,8038,8039,8040,8040,8041,8047,8050,8053,8055,8057,8057,8058,8065,8065,8065,8066,8068,8068,8070,8074,8074,8074,8076,8077,8078,8079,8080,8082,8083,8084,8087,8090,8092,8092,8092,8094,8099,8099,8102,8107,8108,8109,8109,8114,8115,8116,8118,8120,8125,8125,8126,8127,8128,8130,8131,8133,8136,8137,8139,8142,8142,8146,8147,8147,8148,8149,8150,8153,8153,8154,8155,8158,8161,8162,8163,8167,8171,8173,8182,8183,8183,8185,8189,8190,8190,8191,8192,8193,8193,8194,8195,8196,8198,8198,8198,8198,8199,8199,8199,8199,8200,8200,8200,8201,8202,8205,8206,8207,8209,8210,8211,8211,8212,8214,8218,8219,8220,8220,8222,8223,8224,8224,8225,8225,8227,8229,8229,8234,8234,8237,8242,8253,8255,8256,8262,8265,8275,8277,8279,8283,8284,8285,8288,8289,8291,8295,8299,8299,8301,8301,8305,8307,8308,8308,8308,8313,8313,8314,8314,8317,8317,8320,8322,8322,8324,8327,8328,8329,8331,8331,8335,8338,8339,8340,8340,8343,8344,8344,8346,8346,8350,8353,8360,8360,8360,8360,8361,8362,8363,8366,8368,8369,8369,8372,8374,8374,8375,8379,8381,8386,8386,8389,8391,8394,8395,8397,8402,8403,8408,8411,8412,8414,8415,8416,8416,8416,8419,8420,8420,8420,8422,8423,8426,8426,8429,8434,8439,8443,8443,8444,8444,8445,8445,8446,8446,8447,8447,8449,8452,8453,8453,8456,8457,8461,8463,8464,8465,8467,8469,8469,8469,8469,8470,8473,8475,8476,8476,8477,8479,8482,8482,8485,8485,8489,8489,8490,8491,8492,8494,8494,8497,8499,8501,8501,8501,8504,8505,8506,8506,8512,8514,8514,8515,8517,8517,8518,8523,8524,8526,8529,8533,8534,8535,8535,8537,8538,8539,8541,8541,8542,8545,8545,8546,8546,8547,8549,8549,8550,8551,8552,8553,8553,8558,8561,8561,8567,8569,8575,8580,8582,8583,8584,8584,8585,8588,8591,8592,8596,8597,8597,8597,8599,8606,8608,8608,8610,8611,8613,8614,8616,8622,8622,8626,8628,8635,8639,8642,8644,8646,8647,8648,8651,8652,8654,8656,8656,8656,8658,8659,8661,8662,8663,8665,8665,8667,8668,8668,8669,8671,8675,8675,8680,8683,8684,8684,8685,8686,8686,8688,8688,8691,8693,8697,8699,8701,8703,8705,8707,8709,8710,8711,8712,8718,8718,8718,8725,8726,8727,8728,8728,8729,8731,8733,8733,8735,8737,8741,8744,8746,8747,8748,8748,8752,8753,8753,8754,8757,8757,8760,8761,8762,8764,8764,8766,8770,8771,8772,8774,8774,8775,8779,8780,8782,8782,8783,8783,8784,8786,8786,8786,8787,8788,8788,8790,8798,8798,8800,8801,8802,8804,8805,8812,8813,8815,8817,8820,8823,8824,8826,8829,8831,8833,8835,8836,8837,8840,8840,8842,8842,8847,8848,8848,8850,8853,8854,8854,8855,8856,8859,8861,8869,8875,8876,8878,8880,8881,8883,8884,8887,8887,8887,8888,8889,8890,8890,8893,8896,8898,8899,8900,8900,8901,8901,8903,8904,8904,8905,8906,8909,8909,8909,8911,8914,8915,8918,8919,8926,8929,8929,8930,8931,8934,8935,8935,8939,8939,8942,8942,8943,8943,8943,8944,8944,8945,8947,8953,8955,8955,8956,8958,8960,8962,8964,8964,8965,8966,8969,8972,8973,8979,8979,8986,8990,8992,8995,9002,9004,9005,9005,9008,9008,9010,9010,9013,9018,9018,9018,9019,9023,9026,9026,9031,9032,9033,9033,9034,9048,9056,9057,9058,9063,9063,9065,9066,9068,9068,9071,9072,9073,9073,9074,9079,9085,9085,9086,9088,9097,9098,9103,9103,9104,9108,9110,9111,9117,9117,9124,9126,9135,9143,9144,9144,9148,9150,9151,9158,9159,9161,9165,9165,9165,9167,9169,9169,9171,9172,9173,9184,9185,9185,9189,9189,9191,9192,9193,9194,9196,9196,9197,9197,9197,9197,9198,9200,9203,9203,9204,9205,9207,9210,9216,9218,9218,9221,9222,9226,9227,9229,9229,9229,9231,9235,9237,9240,9240,9241,9241,9242,9243,9245,9246,9246,9247,9247,9247,9248,9248,9250,9252,9252,9260,9261,9268,9272,9273,9275,9277,9278,9283,9285,9287,9288,9288,9288,9289,9290,9292,9292,9293,9294,9294,9294,9294,9295,9298,9304,9309,9312,9313,9313,9317,9317,9318,9318,9320,9322,9327,9329,9329,9330,9332,9333,9334,9339,9340,9341,9345,9348,9350,9351,9351,9353,9353,9354,9354,9356,9357,9357,9358,9360,9362,9365,9368,9371,9371,9372,9373,9374,9375,9376,9376,9377,9379,9381,9384,9385,9387,9387,9387,9388,9390,9391,9396,9399,9399,9403,9405,9408,9411,9412,9414,9414,9415,9416,9417,9419,9419,9421,9422,9423,9428,9428,9429,9429,9429,9430,9431,9432,9432,9435,9435,9435,9436,9437,9442,9443,9444,9445,9446,9450,9450,9451,9453,9456,9459,9461,9462,9462,9466,9466,9468,9470,9473,9474,9479,9480,9480,9481,9486,9486,9488,9491,9495,9496,9497,9499,9500,9500,9502,9503,9509,9510,9515,9518,9520,9524,9524,9533,9535,9536,9539,9539,9539,9540,9540,9542,9546,9547,9548,9550,9550,9551,9552,9553,9554,9555,9555,9557,9557,9557,9561,9562,9563,9564,9564,9565,9566,9567,9570,9570,9571,9571,9572,9573,9574,9576,9580,9581,9587,9588,9591,9591,9592,9593,9599,9599,9600,9600,9601,9602,9604,9605,9606,9606,9607,9613,9615,9622,9623,9625,9625,9625,9625,9629,9630,9630,9634,9635,9637,9639,9640,9641,9642,9644,9645,9649,9650,9650,9652,9653,9655,9655,9661,9661,9663,9663,9666,9668,9671,9671,9672,9673,9674,9680,9683,9686,9688,9690,9691,9691,9691,9692,9692,9697,9698,9700,9700,9701,9703,9704,9705,9705,9708,9710,9711,9712,9712,9713,9714,9714,9717,9717,9718,9722,9722,9726,9728,9728,9733,9737,9739,9740,9741,9743,9743,9745,9746,9746,9746,9747,9748,9748,9752,9754,9754,9755,9757,9757,9757,9761,9768,9774,9775,9779,9780,9782,9791,9793,9794,9803,9806,9806,9807,9807,9807,9815,9818,9818,9819,9823,9823,9827,9828,9828,9831,9833,9836,9837,9837,9848,9849,9852,9853,9860,9862,9866,9868,9870,9876,9880,9882,9882,9882,9883,9883,9886,9892,9895,9895,9900,9906,9907,9908,9911,9911,9914,9915,9915,9917,9919,9921,9921,9923,9926,9930,9931,9936,9939,9939,9939,9941,9943,9944,9947,9948,9949,9950,9952,9954,9954,9955,9955,9958,9958,9958,9960,9964,9969,9969,9970,9970,9971,9972,9973,9974,9975,9975,9977,9978,9979,9980,9981,9982,9982,9982,9985,9990,9990,9991,9994,9995,9997,9999,10000,10000,1,1,1,2,2,3,3,3,6,11,15,16,19,19,19,21,23,23,24,24,24,26,28,29,31,32,32,33,38,39,40,40,42,43,44,47,48,48,50,50,51,54,55,57,57,61,69,69,70,73,74,77,79,79,80,83,83,84,85,87,89,90,91,91,91,91,92,94,94,95,96,99,99,101,101,104,104,114,115,116,116,117,117,120,121,122,123,125,126,126,128,128,132,134,138,140,142,142,146,146,146,148,150,150,151,152,158,159,159,159,161,161,161,162,162,165,165,166,166,168,171,173,173,174,176,177,177,177,178,178,179,180,180,180,181,182,183,184,185,189,190,193,194,194,194,196,196,198,198,200,203,204,206,210,211,213,216,216,216,218,218,219,220,220,220,220,221,221,221,221,223,227,228,230,232,232,233,233,234,235,237,239,241,241,242,249,251,251,252,255,256,258,258,258,259,260,260,260,260,262,263,263,265,265,266,269,270,270,271,272,274,275,276,277,278,279,283,283,288,292,293,294,295,297,298,298,299,300,300,302,302,302,302,304,305,305,307,315,318,318,318,319,320,320,322,323,323,325,325,326,326,331,331,333,334,334,335,335,337,340,344,344,345,345,346,347,348,349,353,357,361,364,365,365,366,367,368,368,369,369,369,372,372,372,375,378,378,378,379,380,385,389,389,395,395,396,398,398}));
        System.out.print(minInRotateArray.minNumberInRotateArray(new int[]{7877,7878,7879,7880,7881,7882,7884,7884,7884,7885,7887,7888,7889,7891,7892,7893,7894,7895,7895,7896,7897,7897,7904,7904,7904,7905,7906,7907,7909,7910,7911,7912,7913,7916,7917,7918,7918,7918,7919,7919,7922,7924,7926,7926,7926,7930,7931,7935,7936,7937,7939,7939,7942,7943,7944,7946,7947,7949,7951,7960,7965,7965,7971,7973,7974,7976,7976,7977,7978,7978,7980,7981,7982,7983,7984,7986,7986,7994,7995,7996,7997,7998,7998,8000,8001,8008,8008,8009,8009,8010,8011,8011,8013,8013,8014,8016,8019,8020,8020,8022,8023,8026,8029,8033,8035,8036,8038,8039,8040,8040,8041,8047,8050,8053,8055,8057,8057,8058,8065,8065,8065,8066,8068,8068,8070,8074,8074,8074,8076,8077,8078,8079,8080,8082,8083,8084,8087,8090,8092,8092,8092,8094,8099,8099,8102,8107,8108,8109,8109,8114,8115,8116,8118,8120,8125,8125,8126,8127,8128,8130,8131,8133,8136,8137,8139,8142,8142,8146,8147,8147,8148,8149,8150,8153,8153,8154,8155,8158,8161,8162,8163,8167,8171,8173,8182,8183,8183,8185,8189,8190,8190,8191,8192,8193,8193,8194,8195,8196,8198,8198,8198,819}));
    }

}
